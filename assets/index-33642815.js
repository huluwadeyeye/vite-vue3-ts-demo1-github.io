import{J as N,d as ee,r as m,c as V,K as te,G as le,e as o,o as w,f as O,h as e,w as t,k as g,g as R,i as b,C as z,s as ae,E as q,M as C,_ as oe}from"./index-5e8add3e.js";const ne=(r,v)=>N.get(`/admin/product/baseTrademark/${r}/${v}`),se=r=>r.id?N.put("/admin/product/baseTrademark/update",r):N.post("/admin/product/baseTrademark/save",r),re=r=>N.delete("/admin/product/baseTrademark/remove/"+r),ie=["src"],de=["src"],ue={class:"dialog-footer"},ce=ee({__name:"index",setup(r){const v=m(),p=V({tmName:"",id:"",logoUrl:""}),U=m(),s=V({tmName:"",logoUrl:"",id:""}),h=m([]);let i=m(1),_=m(3),T=m(0),u=m(!1);const M=V({tmName:[{required:!0,message:"请输入品牌名称",trigger:"blur"},{min:3,max:5,message:"3-5位",trigger:"blur"}],logoUrl:[{required:!0,message:"请上传图片",trigger:"change"}]}),j=te(()=>p!=null&&p.id?"修改":"新增");le(()=>{f()});const f=async(n=1)=>{i.value=n;const l=await ne(i.value,_.value);l.code==200&&(T.value=l.data.total||0,h.value=l.data.records||[])},A=()=>{f()},B=n=>{s.logoUrl=n.data},P=n=>{const l=n.name.split("."),k=l[l.length-1];let c=["jpg","png","gif","bmp"];if(c.indexOf(k)>=0){if(n.size/1024/1024>2)return q({type:"warning",message:"不能大于2M"}),!1}else return q({type:"warning",message:`上传图片只支持 ${c.join(" / ")} 格式！`}),!1;return!0},S=()=>{s.id="",u.value=!0},$=n=>{Object.assign(s,n),u.value=!0},G=async n=>{(await re(n)).code==200?(C({type:"success",message:"删除成功"}),f(h.value.length>1?i.value:i.value-1)):C({type:"error",message:"删除失败"})},F=()=>{},H=async()=>{await U.value.validate(),(await se(s)).code==200?(y(),C({type:"success",message:s.id?"修改成功":"新增成功"}),f(1)):(C({type:"error",message:s.id?"修改失败":"新增失败"}),y())},y=()=>{U.value.resetFields(),u.value=!1},I=()=>{v.value.resetFields()};return(n,l)=>{const k=o("el-input"),c=o("el-form-item"),d=o("el-button"),D=o("el-form"),E=o("el-card"),x=o("el-table-column"),J=o("el-popconfirm"),K=o("el-table"),L=o("el-pagination"),Q=o("Plus"),W=o("el-icon"),X=o("el-upload"),Y=o("el-dialog");return w(),O("div",null,[e(E,{class:"search-form"},{default:t(()=>[e(D,{model:p,"label-width":"100px",ref_key:"formRef",ref:v,inline:""},{default:t(()=>[e(c,{label:"品牌名称"},{default:t(()=>[e(k,{modelValue:p.tmName,"onUpdate:modelValue":l[0]||(l[0]=a=>p.tmName=a),modelModifiers:{trim:!0},clearable:"",placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(c,null,{default:t(()=>[e(d,{type:"primary",onClick:F},{default:t(()=>[g("搜索")]),_:1}),e(d,{onClick:I},{default:t(()=>[g("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(E,{style:{"margin-top":"14px"}},{default:t(()=>[e(d,{type:"primary",size:"default",icon:"Plus",onClick:S},{default:t(()=>[g(" 新增品牌 ")]),_:1}),e(K,{style:{margin:"10px 0px"},border:"",data:h.value},{default:t(()=>[e(x,{label:"序号",width:"80px",align:"center",type:"index"}),e(x,{label:"品牌名称",prop:"tmName",align:"center"}),e(x,{label:"品牌LOGO",align:"center"},{default:t(({row:a})=>[R("img",{src:a.logologoUrl,style:{width:"100px",height:"100px"}},null,8,ie)]),_:1}),e(x,{label:"操作",align:"center"},{default:t(({row:a})=>[e(d,{type:"primary",size:"small",icon:"Edit",onClick:Z=>$(a)},null,8,["onClick"]),e(J,{title:`您确定要删除${a.tmName}?`,width:"250px",icon:"Delete",onConfirm:Z=>G(a.id)},{reference:t(()=>[e(d,{type:"primary",size:"small",icon:"Delete"})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),e(L,{onSizeChange:A,onCurrentChange:f,"pager-count":9,"current-page":b(i),"onUpdate:currentPage":l[1]||(l[1]=a=>z(i)?i.value=a:i=a),"page-size":b(_),"onUpdate:pageSize":l[2]||(l[2]=a=>z(_)?_.value=a:_=a),"page-sizes":[3,6,9,12],background:!0,layout:"prev, pager, next, jumper,->,sizes,total",total:b(T)},null,8,["current-page","page-size","total"])]),_:1}),e(Y,{modelValue:b(u),"onUpdate:modelValue":l[5]||(l[5]=a=>z(u)?u.value=a:u=a),title:b(j),width:"500px","before-close":y},{footer:t(()=>[R("span",ue,[e(d,{onClick:y},{default:t(()=>[g("取消")]),_:1}),e(d,{type:"primary",onClick:l[4]||(l[4]=a=>H())},{default:t(()=>[g("确定")]),_:1})])]),default:t(()=>[e(D,{model:s,"label-width":"100px",rules:M,ref_key:"formDlgRef",ref:U},{default:t(()=>[e(c,{label:"品牌名称",prop:"tmName"},{default:t(()=>[e(k,{modelValue:s.tmName,"onUpdate:modelValue":l[3]||(l[3]=a=>s.tmName=a),modelModifiers:{trim:!0},clearable:"",placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(c,{label:"品牌图片",prop:"logoUrl"},{default:t(()=>[e(X,{class:"avatar-uploader",action:"/api/admin/product/fileUpload","show-file-list":!1,"on-success":B,"before-upload":P},{default:t(()=>[s.logoUrl?(w(),O("img",{key:0,src:s.logoUrl,class:"avatar"},null,8,de)):(w(),ae(W,{key:1,class:"avatar-uploader-icon"},{default:t(()=>[e(Q)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});const pe=oe(ce,[["__scopeId","data-v-9e279465"]]);export{pe as default};
