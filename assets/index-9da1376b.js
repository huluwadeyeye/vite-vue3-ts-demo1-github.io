import{J as g,d as N,c as k,r as V,G as O,K as j,e as i,o as h,s as M,w as s,g as A,h as e,k as _,i as d,M as b,_ as q,t as B,C as R,n as z}from"./index-5e8add3e.js";const P=()=>g.get("/admin/acl/permission"),U=r=>r.id?g.put("/admin/acl/permission/update",r):g.post("/admin/acl/permission/save",r),E=r=>g.delete("/admin/acl/permission/remove/"+r),S={class:"dialog-footer"},T=N({__name:"addMenu",props:{showDlg:{type:Boolean,default:!1},id:Number,row:Object},emits:"closeDlg",setup(r,{emit:n}){const u=r;let t=k({code:"",level:0,name:"",pid:0});const p=V(),y=k({});O(()=>{Object.assign(t,u.row),console.log("formData: ",t)});const D=j(()=>u.id?"修改":"新增"),f=()=>{n("closeDlg",!1)},C=async l=>{l&&await l.validate(async(a,c)=>{a?((await U(t)).code==200?b.success(u.id?"修改成功":"新增成功"):b.warning("新增失败"),n("saveDlg",!1)):console.log("error submit!",c)})};return(l,a)=>{const c=i("el-input"),m=i("el-form-item"),w=i("el-form"),v=i("el-button"),x=i("el-dialog");return h(),M(x,{modelValue:r.showDlg,title:d(D),width:"500px","before-close":f},{footer:s(()=>[A("div",S,[e(v,{onClick:f},{default:s(()=>[_("取消")]),_:1}),e(v,{type:"primary",onClick:a[2]||(a[2]=o=>C(p.value))},{default:s(()=>[_("确定")]),_:1})])]),default:s(()=>[A("div",null,[e(w,{model:d(t),"label-width":"100px",ref_key:"formRef",ref:p,rules:y,inline:""},{default:s(()=>[e(m,{label:"菜单名称"},{default:s(()=>[e(c,{placeholder:"请输入菜单名称",modelValue:d(t).name,"onUpdate:modelValue":a[0]||(a[0]=o=>d(t).name=o)},null,8,["modelValue"])]),_:1}),e(m,{label:"权限数值"},{default:s(()=>[e(c,{placeholder:"请输入权限数值",modelValue:d(t).code,"onUpdate:modelValue":a[1]||(a[1]=o=>d(t).code=o)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["modelValue","title"])}}});const F=q(T,[["__scopeId","data-v-d6c89742"]]),I=N({__name:"index",setup(r){let n=V(!1),u=V([]),t=k({code:"",level:0,name:"",pid:0});O(()=>{p()});const p=async()=>{let l=await P();l.code==200&&(u.value=l.data)},y=l=>{console.log("row: ",l),Object.assign(t,{id:0,code:"",level:0,name:"",pid:0}),t.level=l.level+1,n.value=!0,t.pid=l.id},D=l=>{n.value=!0,Object.assign(t,l)},f=()=>{n.value=!1,p()},C=async l=>{(await E(l)).code==200?(b({type:"success",message:"删除成功"}),p()):b({type:"success",message:"删除失败"})};return(l,a)=>{const c=i("el-table-column"),m=i("el-button"),w=i("el-popconfirm"),v=i("el-table"),x=i("el-card");return h(),M(x,null,{default:s(()=>[e(v,{data:d(u),style:{width:"100%","margin-bottom":"20px"},"row-key":"id",border:""},{default:s(()=>[e(c,{label:"名称",prop:"name"}),e(c,{label:"权限值",prop:"code"}),e(c,{label:"修改时间",prop:"updateTime"}),e(c,{label:"操作",width:"300"},{default:s(({row:o,$index:G})=>[e(m,{type:"primary",onClick:$=>y(o),size:"small",disabled:o.level==4},{default:s(()=>[_(B(o.level==3?"添加按钮":"添加菜单"),1)]),_:2},1032,["onClick","disabled"]),e(m,{type:"primary",onClick:$=>D(o),size:"small",disabled:o.level==1},{default:s(()=>[_(" 编辑 ")]),_:2},1032,["onClick","disabled"]),e(w,{title:`你确定要删除${o.name}?`,width:"260px",onConfirm:$=>C(o.id)},{reference:s(()=>[e(m,{type:"danger",size:"small",disabled:o.level==1},{default:s(()=>[_(" 删除 ")]),_:2},1032,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),d(n)?(h(),M(F,{key:0,showDlg:d(n),row:d(t),onCloseDlg:a[0]||(a[0]=o=>R(n)?n.value=!1:n=!1),onSaveDlg:f},null,8,["showDlg","row"])):z("",!0)]),_:1})}}});export{I as default};
